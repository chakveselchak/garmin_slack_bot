{% extends "base.html" %}

{% block title %}Garmin Slack Bot - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è Body Battery{% endblock %}

{% block content %}
<div class="header">
    <h1>‚ö° Garmin Slack Bot</h1>
    <p>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è Body Battery —Å –≤–∞—à–∏–º —Å—Ç–∞—Ç—É—Å–æ–º –≤ Slack</p>
</div>

<div class="status-card">
    <div class="status-icon">üîã</div>
    <div class="status-title">–ù–∞—á–Ω–∏—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é</div>
    <div class="status-description">
        –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç Slack, —á—Ç–æ–±—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å—Ç–∞—Ç—É—Å —Å –¥–∞–Ω–Ω—ã–º–∏ Body Battery –∏–∑ Garmin Connect
    </div>
    
    <a href="/slack/oauth/start" class="btn" style="display: inline-block; text-decoration: none; margin-top: 1.5rem;" id="slackBtn" onclick="showSlackLoader(this)">
        <span id="slackBtnText">üöÄ –ü–æ–¥–∫–ª—é—á–∏—Ç—å Slack</span>
        <span id="slackBtnLoader" style="display: none;">
            <svg style="width: 18px; height: 18px; margin-right: 8px; animation: spin 1s linear infinite;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="m12 6-4 4 4 4"></path>
            </svg>
            –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...
        </span>
    </a>
</div>

<div style="text-align: center; margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid #e1e5e9;">
    <h3 style="color: #2e2e2e; margin-bottom: 1rem;">–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?</h3>
    <div style="text-align: left; max-width: 400px; margin: 0 auto;">
        <div style="margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;">
            <span style="background: #667eea; color: white; border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; font-weight: bold;">1</span>
            <span style="font-size: 0.9rem;">–ü–æ–¥–∫–ª—é—á–∏—Ç–µ Slack –∞–∫–∫–∞—É–Ω—Ç</span>
        </div>
        <div style="margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;">
            <span style="background: #667eea; color: white; border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; font-weight: bold;">2</span>
            <span style="font-size: 0.9rem;">–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ Garmin Connect</span>
        </div>
        <div style="margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;">
            <span style="background: #667eea; color: white; border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; font-weight: bold;">3</span>
            <span style="font-size: 0.9rem;">–°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç</span>
        </div>
    </div>
</div>

<style>
@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.btn.loading {
    opacity: 0.8;
    pointer-events: none;
}
</style>

<script>
function showSlackLoader(element) {
    const btnText = document.getElementById('slackBtnText');
    const btnLoader = document.getElementById('slackBtnLoader');
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–æ–∞–¥–µ—Ä
    element.classList.add('loading');
    btnText.style.display = 'none';
    btnLoader.style.display = 'inline-flex';
    btnLoader.style.alignItems = 'center';
    btnLoader.style.justifyContent = 'center';
    
    // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º
    setTimeout(() => {
        window.location.href = element.href;
    }, 300);
    
    return false;
}

// –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
window.addEventListener('pageshow', function(event) {
    if (event.persisted) {
        const slackBtn = document.getElementById('slackBtn');
        const btnText = document.getElementById('slackBtnText');
        const btnLoader = document.getElementById('slackBtnLoader');
        
        if (slackBtn) {
            slackBtn.classList.remove('loading');
            btnText.style.display = 'inline';
            btnLoader.style.display = 'none';
        }
    }
});
</script>
{% endblock %} 