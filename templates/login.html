{% extends "base.html" %}

{% block title %}–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Garmin Connect - Garmin Slack Bot{% endblock %}

{% block content %}
<div class="header">
    <h1>üîó –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Garmin Connect</h1>
    <p>–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Garmin Connect</p>
</div>

<form method="POST" id="garminForm">
    <div class="form-group">
        <label class="form-label" for="email">
            üìß Email Garmin Connect
        </label>
        <input 
            type="email" 
            id="email"
            name="email" 
            class="form-input"
            placeholder="your.email@example.com"
            required
            autocomplete="email"
        >
    </div>
    
    <div class="form-group">
        <label class="form-label" for="password">
            üîí –ü–∞—Ä–æ–ª—å
        </label>
        <input 
            type="password" 
            id="password"
            name="password" 
            class="form-input"
            placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ø–∞—Ä–æ–ª—å"
            required
            autocomplete="current-password"
        >
    </div>
    
    <button type="submit" class="btn" id="submitBtn">
        <span id="btnText">üöÄ –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∏ –Ω–∞—á–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é</span>
        <span id="btnLoader" style="display: none;">
            <svg style="width: 20px; height: 20px; margin-right: 8px; animation: spin 1s linear infinite;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="m12 6-4 4 4 4"></path>
            </svg>
            –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...
        </span>
    </button>
</form>

<div style="text-align: center; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid #e1e5e9;">
    <p style="color: #666; font-size: 0.85rem; margin: 0;">
        üîê –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –Ω–∞–¥–µ–∂–Ω–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è Body Battery
    </p>
</div>

<style>
@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.btn:disabled {
    opacity: 0.7;
    cursor: not-allowed;
    transform: none !important;
}

.btn:disabled:hover {
    transform: none !important;
    box-shadow: none !important;
}

.form-input:disabled {
    background-color: #f8f9fa;
    cursor: not-allowed;
}
</style>

<script>
document.getElementById('garminForm').addEventListener('submit', function(e) {
    const submitBtn = document.getElementById('submitBtn');
    const btnText = document.getElementById('btnText');
    const btnLoader = document.getElementById('btnLoader');
    const emailInput = document.getElementById('email');
    const passwordInput = document.getElementById('password');
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ñ–æ—Ä–º–∞ –≤–∞–ª–∏–¥–Ω–∞
    if (!emailInput.value || !passwordInput.value) {
        return;
    }
    
    // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–æ–∞–¥–µ—Ä
    submitBtn.disabled = true;
    emailInput.disabled = true;
    passwordInput.disabled = true;
    
    btnText.style.display = 'none';
    btnLoader.style.display = 'inline-flex';
    btnLoader.style.alignItems = 'center';
    btnLoader.style.justifyContent = 'center';
    
    // –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É –¥–ª—è –ø–æ–∫–∞–∑–∞ –ª–æ–∞–¥–µ—Ä–∞
    setTimeout(() => {
        // –§–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–æ–±—ã—Ç–∏—è
    }, 100);
});

// –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
window.addEventListener('pageshow', function(event) {
    if (event.persisted) {
        const submitBtn = document.getElementById('submitBtn');
        const btnText = document.getElementById('btnText');
        const btnLoader = document.getElementById('btnLoader');
        const emailInput = document.getElementById('email');
        const passwordInput = document.getElementById('password');
        
        submitBtn.disabled = false;
        emailInput.disabled = false;
        passwordInput.disabled = false;
        
        btnText.style.display = 'inline';
        btnLoader.style.display = 'none';
    }
});
</script>
{% endblock %}
