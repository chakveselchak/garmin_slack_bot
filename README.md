# Garmin Slack Bot - Body Battery Integration

## –û–ø–∏—Å–∞–Ω–∏–µ
App –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–∞—à–µ–≥–æ —Ç–µ–∫—É—â–µ–≥–æ BodyBattery (–∏–∑ Garmin Connect) –≤ —Å—Ç–∞—Ç—É—Å–µ –ø—Ä–æ—Ñ–∏–ª—è –≤ Slack. –ï—Å–ª–∏ —É—Ä–æ–≤–µ–Ω—å BodyBattery < 35%, —Ç–æ –≤ —Å—Ç–∞—Ç—É—Å –¥–æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Ç–µ–∫—Å—Ç: "–ü—Ä–æ—Å—å–±–∞ –Ω–µ –∑–≤–æ–Ω–∏—Ç—å. –û—Ç–≤–µ—á—É —Ç–µ–∫—Å—Ç–æ–º".
–ò–º–µ–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞ –∏–∫–æ–Ω–æ–∫:
- –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –≤–∏–¥. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∏–∫–æ–Ω–∫–∞ –±–∞—Ç–∞—Ä–µ–π–∫–∏
- –ò–≥—Ä–æ–≤–æ–π –≤–∏–¥. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∏–∫–æ–Ω–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –∏–∑ DOOM. –ò–∫–æ–Ω–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –Ω–∞–¥–æ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤ Slack —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ. –ò–∫–æ–Ω–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ doom pack.


### –ß—Ç–æ —Ç–∞–∫–æ–µ Body Battery?
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø–∞—Å —ç–Ω–µ—Ä–≥–∏–∏ –≤–∞—à–µ–≥–æ –æ—Ä–≥–∞–Ω–∏–∑–º–∞ –∏ –ø–æ–º–æ–≥–∞–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–∏–ª—ã –Ω–∞ –¥–µ–Ω—å.
–í—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –Ω–∞—á–∞–ª–µ –¥–Ω—è –∏ –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –≤—ã —Å–æ–±–∏—Ä–∞–µ—Ç–µ—Å—å –Ω–∞—á–∞—Ç—å –∑–∞–Ω—è—Ç–∏–µ.
–ù–∏–∑–∫–æ–µ –∑–Ω–∞—á–Ω–∏–µ —è–≤–ª—è–µ—Ç—Å—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –≤ –∫–æ–Ω—Ü–µ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∏–ª–∏ –Ω–∞–ø—Ä—è–∂–µ–Ω–Ω–æ–≥–æ –¥–Ω—è.

### –ö–∞–∫ Garmin —Ä–∞—Å—á–∏—Ç—ã–≤–∞—é—Ç BodyBattery?
Body Battery —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø—É—Ç–µ–º –∞–Ω–∞–ª–∏–∑–∞ —Å–∏–≥–Ω–∞–ª–æ–≤, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –æ—Ç –≤–∞—à–µ–≥–æ —Å–µ—Ä–¥—Ü–∞, —Ç–∞–∫–∏—Ö –∫–∞–∫ –≤–∞—Ä–∏–∞–±–µ–ª—å–Ω–æ—Å—Ç—å —á–∞—Å—Ç–æ—Ç—ã –ø—É–ª—å—Å–∞ –∏ —É—Ä–æ–≤–µ–Ω—å —Å—Ç—Ä–µ—Å—Å–∞, –∞ —Ç–∞–∫–∂–µ –∫–∞—á–µ—Å—Ç–≤–æ —Å–Ω–∞ –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å. –í–°–†
- —ç—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –º–µ–∂–¥—É –∫–∞–∂–¥—ã–º —Å–µ—Ä–¥—Ü–µ–±–∏–µ–Ω–∏–µ–º. –≠—Ç–æ –∫–ª—é—á–µ–≤–æ–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å —Ç–æ–≥–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –≤–∞—à –æ—Ä–≥–∞–Ω–∏–∑–º —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ —Å—Ç—Ä–µ—Å—Å–æ–º, —Å–≤—è–∑–∞–Ω–Ω—ã–º —Å –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π –∂–∏–∑–Ω—å—é –∏ –∑–∞–Ω—è—Ç–∏—è–º–∏.
–ü—Ä–∏–µ–º –ø–∏—â–∏ –Ω–∞–ø—Ä—è–º—É—é –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π, –æ–¥–Ω–∞–∫–æ –∑–¥–æ—Ä–æ–≤–æ–µ –∏ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ –≤—Å–µ–≥–¥–∞ –∏–¥–µ—Ç –Ω–∞ –ø–æ–ª—å–∑—É.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### üñ• –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- **Python 3.8+**
- **–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**: Windows, macOS, Linux
- **–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ** –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Garmin Connect –∏ Slack API

### üì¶ Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```
Flask-SQLAlchemy
gunicorn
SQLAlchemy
slack_sdk
schedule
python-dotenv
garminconnect
cryptography
```

–£—Å—Ç–∞–Ω–æ–≤–∫–∞: `pip install -r requirements.txt`

### üîó Slack App —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
–î–ª—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å Slack App —Å —Å–ª–µ–¥—É—é—â–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:

#### OAuth & Permissions:
- **Bot Token Scopes**:
  - `users.profile:write` - –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `users.profile:read` - –¥–ª—è —á—Ç–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### Redirect URLs:
- `https://yourdomain.com/slack/oauth/callback` (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
- `https://localhost:5000/slack/oauth/callback` (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

### üë§ Garmin Connect —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- **–ê–∫—Ç–∏–≤–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç Garmin Connect**
- **–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ Garmin** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Body Battery (–Ω–∞–ø—Ä–∏–º–µ—Ä, Fenix, Vivoactive, Forerunner —Å–µ—Ä–∏–∏)
- **–†–µ–≥—É–ª—è—Ä–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å Garmin Connect

### üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:
```env
SLACK_CLIENT_ID=your_slack_client_id
SLACK_CLIENT_SECRET=your_slack_client_secret
FERNET_SECRET_KEY=your_32_byte_encryption_key
```

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:
```python
from cryptography.fernet import Fernet
print(Fernet.generate_key().decode())
```

### üéÆ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è 
#### –¥–ª—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∂–∏–º–∞:
–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∂–∏–º–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:
- **–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ —ç–º–æ–¥–∂–∏** –≤ –≤–∞—à Slack workspace:
  - `:battery0:` 
  - `:battery1:`
  - `:battery2:`
  - `:battery3:`
  - `:battery4:`
  - `:battery5:`
  - `:battery6:`
  - `:battery7:`
  - `:battery8:` 
  - `:battery9:`
  - `:battery10:` 
  
#### –¥–ª—è —Ä–µ–∂–∏–º–∞ DOOM:
–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–≥—Ä–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:
- **–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ —ç–º–æ–¥–∂–∏** –≤ –≤–∞—à Slack workspace:
  - `:doom0:` - –ø–æ–ª–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ (86%+)
  - `:doom1:` - –æ—Ç–ª–∏—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (72-85%)
  - `:doom2:` - —Ö–æ—Ä–æ—à–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (58-71%)
  - `:doom3:` - –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (44-57%)
  - `:doom4:` - —É—Å—Ç–∞–ª–æ—Å—Ç—å (30-43%)
  - `:doom5:` - –Ω–∏–∑–∫–∞—è —ç–Ω–µ—Ä–≥–∏—è (25-29%)
  - `:doom6:` - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (20-24%)
  - `:doom7:` - –∏—Å—Ç–æ—â–µ–Ω–∏–µ (<20%)

**–§–∞–π–ª—ã —ç–º–æ–¥–∂–∏**: –ò–∫–æ–Ω–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `doom pack` (–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∏—Ö –≤ Slack ‚Üí Customize ‚Üí Emoji)

## –§—É–Ω–∫—Ü–∏–∏

### üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å Rate Limiting
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Å—Å–∏–π**: –°–µ—Å—Å–∏–∏ Garmin Connect —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –Ω–∞ 24 —á–∞—Å–∞
- **–£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã**: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç 
- **–£–º–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏**: –°–ª—É—á–∞–π–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ (2-5 –º–∏–Ω—É—Ç –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏)
- **–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø–æ–≤—Ç–æ—Ä—ã**: –ü—Ä–∏ –æ—à–∏–±–∫–µ 429 –æ–∂–∏–¥–∞–Ω–∏–µ 5-10 –º–∏–Ω—É—Ç

### üìä –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
1. **–ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å** - –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è Garmin
2. **–ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã** - –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç —Å —Å–ª—É—á–∞–π–Ω—ã–º–∏ –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏
3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Å–µ—Å—Å–∏–∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —á–∞—Å—Ç—ã—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–π

### üõ† –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- `/` - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏
- `/connect-garmin` - –∫—Ä–∞—Å–∏–≤–∞—è —Ñ–æ—Ä–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è Garmin
- `/status` - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏
- `/test-battery` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–∏—è Body Battery
- `/clear-cache` - –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ —Å–µ—Å—Å–∏–π Garmin

### üîç –û—Ç–ª–∞–¥–∫–∞
–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π:
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `/clear-cache` –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ 429
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–∏–µ

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
garmin_slack_bot/
‚îú‚îÄ‚îÄ app.py              # –û—Å–Ω–æ–≤–Ω–æ–µ Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ garmin.py           # –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å Garmin API (—Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º)
‚îú‚îÄ‚îÄ scheduler.py        # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á (15 –º–∏–Ω –∏–Ω—Ç–µ—Ä–≤–∞–ª)
‚îú‚îÄ‚îÄ slack_api.py        # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–æ Slack
‚îú‚îÄ‚îÄ models.py           # –ú–æ–¥–µ–ª–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ oauth.py            # OAuth –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
```

